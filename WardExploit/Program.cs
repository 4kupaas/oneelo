using System;
using EloBuddy;
using EloBuddy.SDK;
using EloBuddy.SDK.Events;
using EloBuddy.SDK.Menu.Values;

namespace WardExploit
{
    internal class Program
    {
        public static AIHeroClient player => Player.Instance;

        private static void Main(string[] args)
        {
            Loading.OnLoadingComplete += Loading_OnLoadingComplete;
        }

        private static void Loading_OnLoadingComplete(EventArgs args)
        {
            MenuHandler.Initialize();
            Game.OnTick += Game_OnTick;
        }

        private static void Game_OnTick(EventArgs args)
        {
            // check player is at shop
            if (!player.IsInShopRange() || Game.MapId != GameMapId.SummonersRift)
                return;

            // trinket ids
            const int totem = 3340;
            const int lens = 3341;
            const int farsight = 3363;
            const int oracle = 3364;

            InventorySlot trinket = null;

            foreach (var item in player.InventoryItems)
                if ((int)item.Id == totem || (int)item.Id == lens || (int)item.Id == farsight || (int)item.Id == oracle)
                    trinket = item;

            // If no item is in trinket slot
            if (trinket == null)
                Shop.BuyItem(totem);
            else if(!MenuHandler.GetCheckboxValue(MenuHandler.mainMenu, "Only purchase if on cooldown") || !trinket.CanUseItem())
            {
                int sliderValue = MenuHandler.GetSliderValue(MenuHandler.mainMenu, "Ward Type:");

                if (sliderValue == 0 && !player.HasItem(totem))
                    Shop.BuyItem(totem);
                else if (sliderValue == 1 && !player.HasItem(lens))
                    Shop.BuyItem(lens);
                else if (sliderValue == 2 && !player.HasItem(farsight))
                    Shop.BuyItem(farsight);
                else if (sliderValue == 3 && !player.HasItem(oracle))
                    Shop.BuyItem(oracle);
            }
        }
        
        // Ward Slider display
        public static void WardSlider_OnValueChange(ValueBase<int> sender, ValueBase<int>.ValueChangeArgs args)
        {
            int value = 0;
            if (args != null)
                value = args.NewValue;
            else
                value = sender.CurrentValue;

            if (value == 0)
                sender.DisplayName = "Ward Type: Warding Totem";
            else if (value == 1)
                sender.DisplayName = "Ward Type: Sweeping Lens";
            else if (value == 2)
                sender.DisplayName = "Ward Type: Farsight Trinket";
            else if (value == 3)
                sender.DisplayName = "Ward Type: Oracles Lens";
        }
    }
}